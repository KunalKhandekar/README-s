# Payment Gateway Integration

## What is a Payment Gateway?

    -> A payment gateway is like a digital middleman that helps transfer money safely when you pay online.
    -> It connects the customer (you), the merchant (shop/website/app), and the bank/payment provider.
    -> Example: When you buy something on Amazon and pay using UPI, card, or net banking, the payment gateway makes sure the money moves securely.

    Why Do We Need to Know About It?
        -> Secure Payments → It ensures that money transfer is safe (your card details or UPI PIN aren’t exposed directly).
        -> Faster Transactions → Without it, every website would have to build its own banking system, which is very hard.
        -> Multiple Options → Payment gateways allow users to pay using cards, UPI, wallets, net banking, EMI, etc.
        -> Trust Factor → Customers trust platforms that use reliable gateways (like Razorpay, PayPal, Stripe).
        -> For Developers/Businesses → If you build an app or website where users need to pay, you must integrate a payment gateway.

    Where Do We Use a Payment Gateway?
        -> E-commerce websites → Amazon, Flipkart, Myntra.
        -> Food delivery apps → Swiggy, Zomato.
        -> Ride booking apps → Uber, Ola.
        -> Online services → Netflix, Spotify, Hotstar subscriptions.
        -> Utility payments → Electricity bills, phone recharges, gas bills.
        -> Freelancers & businesses → To receive payments from clients/customers online.

    How Does It Work (Simple Flow)?
        -> You place an order and choose a payment option.
        -> Payment gateway encrypts (locks) your card/UPI details.
        -> It checks with your bank if you have money.
        -> If yes → money is deducted → confirmation sent to merchant.
        -> Merchant gets the money (sometimes instantly, sometimes after 1–2 days).

    Examples of Payment Gateways
        India → Razorpay, PayU, Cashfree, CCAvenue, Instamojo, Paytm PG.
        Global → PayPal, Stripe, Square, Authorize.Net.

## Different Ways to Receive Payments in Razorpay

    1. Payment Links
        -> You create a unique link and send it via WhatsApp, SMS, Email, or social media.
        -> Customer clicks the link → pays using UPI, card, wallet, etc.
        -> Best for freelancers, small shops, or one-time payments.

    2. Payment Pages
        -> Ready-made mini-website created inside Razorpay (no coding needed).
        -> You can add your logo, product details, and pricing.
        -> Customer visits the page and pays directly.
        -> Example: “Buy tickets”, “Donate now” pages.

    3. Payment Buttons
        -> Small button you can put on your website/blog.
        -> Example: “Pay Now” or “Donate” button.
        -> Clicking it opens Razorpay’s checkout.
        -> Useful for simple websites without heavy backend.

    4. Checkout (Integration in Website/App)
        -> Razorpay’s checkout form is integrated into your app/website.
        -> Users stay on your site, choose payment method, and pay.
        -> Supports UPI, cards, wallets, net banking, EMI.
        -> Best for professional e-commerce sites.

    5. QR Codes
        -> Razorpay lets you generate UPI QR codes.
        -> Customer scans with Google Pay, PhonePe, Paytm, etc.
        -> Amount can be fixed or open.
        -> Great for shops, restaurants, offline use.

    6. Subscriptions
        -> For recurring payments (monthly/yearly).
        -> Example: Netflix, gym memberships, SaaS tools.
        -> Razorpay auto-deducts amount as per plan.

    7. Invoices
        -> Create a professional invoice in Razorpay with customer name, amount, due date.
        -> Invoice includes a payment link.
        -> Customer can pay directly from the invoice.

    8. Smart Collect (Virtual Accounts & UPI IDs)
        -> Razorpay gives you a unique bank account/UPI ID for each customer.
        -> Customer transfers money → Razorpay auto-tracks and settles.
        -> Best for businesses handling bulk/enterprise payments.

## Enable International Payments in RazorPay

    You can add your paypal account for accepting International Payments

## Orders in razorpay

    ⚡ What is an Order ID in Razorpay?
        -> An Order ID is a unique identifier (order_xxxxxxx) generated by Razorpay when you create an order.
        -> It acts like a token or reference number for that specific payment request.
        -> Example: If a customer wants to pay ₹1000, you first create an order in Razorpay → it gives you order_Jh8u78uXk.

    ⚡ When is an Order Created?
        -> Orders are created before a payment happens.
        -> You (the merchant/server) call Razorpay’s Orders API and specify:
            -> Amount
            -> Currency (INR/USD/other)
            -> Notes (optional info like “Invoice #123”)
            -> Receipt ID (your internal tracking)
        -> Then Razorpay returns an order_id.

    ⚡ Which Payment Modes Use Order ID?
        -> Razorpay Checkout (Website/App Integration) → Mandatory to use order_id.
        -> Subscriptions → Each recurring charge is tied to an order.
        -> International Payments → Order is required.
        -> Invoices / Payment Links / Payment Pages → Razorpay creates the order in the background automatically.

    ⚡ Supported payment methods with Order ID:
        -> UPI
        -> Cards (credit/debit)
        -> Netbanking
        -> Wallets (Paytm, PhonePe, etc.)
        -> EMI / BNPL
        -> International cards
        
    ⚡ Different Statuses of an Order
        Created → Order has been created but no payment attempt yet.
        Attempted → At least one payment attempt was made (success or failure).
        Paid → Payment successful, order completed.

    ⚡ Relation Between Payment and Order
        -> Every Payment belongs to an Order → Payment ID (pay_xxxxx) is always attached to an Order ID (order_xxxxx).
        -> One Order can have many Payments (multiple attempts) → Only one successful payment can mark it as Paid.
        -> You cannot have a payment without an order (in most integrations).

## Payment Status in Razorpay

    In Razorpay, every payment goes through a lifecycle and has different statuses to help you track whether the money has been successfully received, is in process, or failed. Here are the main payment statuses explained:

    1. Created
        -> This is the initial state when a payment is initiated but not yet attempted by the customer.
        -> Example: When you create a payment/order via API but the customer hasn’t entered payment details yet.

    2. Authorized
        -> The payment has been approved by the customer’s bank/card issuer, but Razorpay has not yet captured the amount.
        -> Money is blocked in the customer’s account but not yet received by you.
        -> You (merchant) must capture the payment to receive funds (can be automatic or manual).

    3. Captured
        -> The payment is successfully captured, meaning the money is now debited from the customer and will be settled to your Razorpay account.
        -> This is the final successful state for a payment.

    4. Failed
        -> The payment attempt was made, but it didn’t go through due to reasons like insufficient balance, incorrect card details, authentication failure, or network error.

    5. Refunded
        -> If you initiate a refund (full or partial), the payment status changes to Refunded once the money is successfully returned to the customer.

## Razorpay API Guide

    Check out the API Docs at: https://www.postman.com/razorpaydev/workspace/razorpay-public-workspace/collection/12492020-952c7295-118c-400f-8f2c-5266ef6f689a

## Basic Auth

    ⚡ Definition:
        A simple HTTP authentication method where the client sends a username and password to the server.

    ⚡ Process:
        -> Client requests a protected resource.
        -> Server responds with 401 Unauthorized and asks for credentials.
        -> Client encodes username:password in Base64.
        -> Adds it to the request header:
            Authorization: Basic <Base64-credentials>
        -> Server decodes and verifies.

    ⚡ Security:
        -> Base64 ≠ encryption, just encoding.
        -> Vulnerable if used without HTTPS (credentials can be stolen).
        -> Credentials are sent with every request.

    ⚡ Use Cases:
        -> Internal tools, simple APIs, testing, or temporary setups.
        -> Always combined with HTTPS in real-world use.

    ⚡ Limitations:
        -> Weak compared to modern methods (Bearer tokens, JWT).
        -> High risk if intercepted.

    ⚡ Example:
        const token = btoa('<API_KEY>:<API_SECRET>');

        const res = await fetch("https://api.razorpay.com/v1/payments", {
            headers: {
                "Authorization": `Basic ${token}`
            }
        });

        console.log(await res.json())
